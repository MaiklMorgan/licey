/*!
 * jQuery Expander Plugin v1.4.5.1
 *
 * Date: Mon Jan 14 14:44:48 2013 EST
 * Requires: jQuery v1.3+
 *
 * Copyright 2013, Karl Swedberg
 * Licensed under the MIT License:
 * http://www.opensource.org/licenses/mit-license.php
 *
 *
 *
 *
 *
*/
(function(a){a.expander={version:"1.4.5",defaults:{slicePoint:100,preserveWords:true,widow:4,expandText:"read more",expandPrefix:"&hellip; ",expandAfterSummary:false,summaryClass:"summary",detailClass:"details",moreClass:"read-more",lessClass:"read-less",collapseTimer:0,expandEffect:"slideDown",expandSpeed:250,collapseEffect:"slideUp",collapseSpeed:200,userCollapse:true,userCollapseText:"read less",userCollapsePrefix:" ",onSlice:null,beforeExpand:null,afterExpand:null,onCollapse:null,afterCollapse:null}};a.fn.expander=function(r){var n="init";if(typeof r=="string"){n=r;r={}}var b=a.extend({},a.expander.defaults,r),e=/^<(?:area|br|col|embed|hr|img|input|link|meta|param).*>$/i,l=b.wordEnd||/(&(?:[^;]+;)?|[a-zA-Z\u00C0-\u0100]+)$/,k=/<\/?(\w+)[^>]*>/g,h=/<(\w+)[^>]*>/g,m=/<\/(\w+)>/g,d=/(<\/[^>]+>)\s*$/,o=/^(<[^>]+>)+.?/,p;var g={init:function(){this.each(function(){var P,O,V,C,U,T,K,u,W,z,L,v,M,Q,x=[],J=[],y={},S=this,E=a(this),B=a([]),N=a.extend({},b,E.data("expander")||a.meta&&E.data()||{}),t=!!E.find("."+N.detailClass).length,F=!!E.find("*").filter(function(){var X=a(this).css("display");return(/^block|table|list/).test(X)}).length,w=F?"div":"span",H=w+"."+N.detailClass,A=N.moreClass+"",R=N.lessClass+"",s=N.expandSpeed||0,D=a.trim(E.html()),G=a.trim(E.text()),I=D.slice(0,N.slicePoint);N.moreSelector="span."+A.split(" ").join(".");N.lessSelector="span."+R.split(" ").join(".");if(a.data(this,"expanderInit")){return}a.data(this,"expanderInit",true);a.data(this,"expander",N);a.each(["onSlice","beforeExpand","afterExpand","onCollapse","afterCollapse"],function(X,Y){y[Y]=a.isFunction(N[Y])});I=j(I);U=I.replace(k,"").length;while(U<N.slicePoint){C=D.charAt(I.length);if(C=="<"){C=D.slice(I.length).match(o)[0]}I+=C;U++}I=j(I,N.preserveWords);T=I.match(h)||[];K=I.match(m)||[];V=[];a.each(T,function(X,Y){if(!e.test(Y)){V.push(Y)}});T=V;O=K.length;for(P=0;P<O;P++){K[P]=K[P].replace(m,"$1")}a.each(T,function(X,aa){var Y=aa.replace(h,"$1");var Z=a.inArray(Y,K);if(Z===-1){x.push(aa);J.push("</"+Y+">")}else{K.splice(Z,1)}});J.reverse();if(!t){W=D.slice(I.length);z=a.trim(W.replace(k,""));if(z===""||z.split(/\s+/).length<N.widow){return}u=J.pop()||"";I+=J.join("");W=x.join("")+W}else{W=E.find(H).remove().html();I=E.html();D=I+W;u=""}N.moreLabel=E.find(N.moreSelector).length?"":q(N);if(F){W=D}I+=u;N.summary=I;N.details=W;N.lastCloseTag=u;if(y.onSlice){V=N.onSlice.call(S,N);N=V&&V.details?V:N}L=f(N,F);E.html(L);M=E.find(H);Q=E.find(N.moreSelector);if(N.collapseEffect==="slideUp"&&N.expandEffect!=="slideDown"||E.is(":hidden")){M.css({display:"none"})}else{M[N.collapseEffect](0)}B=E.find("div."+N.summaryClass);v=function(X){X.preventDefault();Q.hide();B.hide();if(y.beforeExpand){N.beforeExpand.call(S)}M.stop(false,true)[N.expandEffect](s,function(){M.addClass("visible").css({zoom:""});if(y.afterExpand){N.afterExpand.call(S)}i(N,M,S)})};Q.find("a").unbind("click.expander").bind("click.expander",v);if(N.userCollapse&&!E.find(N.lessSelector).length){E.find(H).append('<span class="'+N.lessClass+'">'+N.userCollapsePrefix+'<a href="#">'+N.userCollapseText+"</a></span>")}E.find(N.lessSelector+" a").unbind("click.expander").bind("click.expander",function(X){X.preventDefault();clearTimeout(p);var Y=a(this).closest(H).removeClass("visible");c(N,Y);if(y.onCollapse){N.onCollapse.call(S,true)}})})},destroy:function(){this.each(function(){var u,s,t=a(this);if(!t.data("expanderInit")){return}u=a.extend({},t.data("expander")||{},b),s=t.find("."+u.detailClass).contents();t.removeData("expanderInit");t.removeData("expander");t.find(u.moreSelector).remove();t.find("."+u.summaryClass).remove();t.find("."+u.detailClass).after(s).remove();t.find(u.lessSelector).remove()})}};if(g[n]){g[n].call(this)}function f(v,u){var t="span",s=v.summary;if(u){t="div";if(d.test(s)&&!v.expandAfterSummary){s=s.replace(d,v.moreLabel+"$1")}else{s+=v.moreLabel}s='<div class="'+v.summaryClass+'">'+s+"</div>"}else{s+=v.moreLabel}return[s,"<",t+' class="'+v.detailClass+'"',">",v.details,"</"+t+">"].join("")}function q(t){var s='<span class="'+t.moreClass+'">'+t.expandPrefix;s+='<a href="#">'+t.expandText+"</a></span>";return s}function j(s,t){if(s.lastIndexOf("<")>s.lastIndexOf(">")){s=s.slice(0,s.lastIndexOf("<"))}if(t){s=s.replace(l,"")}return a.trim(s)}function c(t,s){s.stop(true,true)[t.collapseEffect](t.collapseSpeed,function(){var u=s.prev("span."+t.moreClass).show();if(!u.length){s.parent().children("div."+t.summaryClass).show().find("span."+t.moreClass).show()}if(t.afterCollapse){t.afterCollapse.call(s)}})}function i(t,s,u){if(t.collapseTimer){p=setTimeout(function(){c(t,s);if(a.isFunction(t.onCollapse)){t.onCollapse.call(u,false)}},t.collapseTimer)}}return this};a.fn.expander.defaults=a.expander.defaults})(jQuery);